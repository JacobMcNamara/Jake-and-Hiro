%!TEX root = mcnamara-tanaka.tex

\section{The structure sheaf}

Consider the simplest case of an implicit atlas $\cA$ with a single global chart, given by a smooth manifold $Y$, a smooth function $s: Y \to E$ into a finite dimensional vector space $E$, and the zero set $X = s^{-1}(0)$. Since the following diagram should be a pullback,
\[ \xymatrix{X \ar[r] \ar[d] & Y \ar[d]^-{s} \\ {*} \ar[r]_-{0} & E}\]
we would like to have that the $C^\oo$-ring $\cO(X)$ is the homotopy tensor product, $\cO(X) = \RR \tensor_{\cO(E)} \cO(Y)$.

\hiro{Great simple example, and nice motivation. This could be cast as "Example x.y.z" after we finish writing a definition we know to be correct.}

\subsection{The cospan nerve of a category}

\begin{definition}\label{cospan-nerve}
Let $\cC$ be a category. We construct a simplicial set $\CoSpan^\bullet(\cC)$, the {\bf cospan nerve} of $\cC$, as follows. Let $\cP_+(n)$ denote the poset of nonempty subsets of the set $[n] = \{0, \dots, n\}$. We define
\[ \CoSpan^n(\cC) = \Fun(\cP_+(n), \cC), \]
the set of functors from $\cP_+(n)$ to $\cC$. Given a map $f: [n] \to [m]$, we get an induced map $\CoSpan^m(\cC) \to \CoSpan^n(\cC)$ given by pulling back along $f$, and so $\CoSpan^\bullet(\cC)$ is a simplicial set.
\end{definition}

\begin{prop}\label{cospans-are-kan}
Let $\cC$ be a category with weak pushouts. Then $\CoSpan^\bullet(\cC)$ is a Kan complex.
\end{prop}

\begin{proof}
\jake{[To be completed.]}
\end{proof}

\begin{speculation}
Suppose $\cC$ is a category with weak pushouts and a weak initial object. Then $\CoSpan^\bullet(\cC)$ is contractible.
\end{speculation}

\subsection{Category of thickenings}

\begin{definition}
A {\bf thickening chart}  $\cU = (Y, E, f)$ consists of a smooth manifold $Y$, together with a smooth vector bundle $E$ over $Y$ and a smooth section $f: Y \to E$. Given two thickening charts $\cU_i = (Y_i, E_i, f_i)$ for $i = 0, 1$, a morphism $\cU_0 \to \cU_1$ is a smooth embedding $i: Y_0 \hookrightarrow Y_1$ together with an inclusion of vector bundles $j: E_0 \hookrightarrow i^* E_1$ such that $j \circ f_0 = i^*(f_1)$, and such that the induced diagram
\[\xymatrix{
		Y_0 \ar[d]_-{f_0} \ar@{^{(}->}[r]^-{i} & Y_1 \ar[d]^-{f_1} \\
		E_0 \ar@{^{(}->}[r]_-{\widetilde{\jmath}} & E_1}\]
is a transverse pullback of smooth manifolds. We let $\cT$ denote the category whose objects are thickening charts, and whose morphisms are morphisms of thickening charts.
\end{definition}

\begin{wild-speculation}\label{model-category}
Consider the category whose objects are thickening charts, and whose morphisms are the same as morphisms of thickening charts but without the condition that $i$ and $\widetilde{\jmath}$ above be embeddings or the transverse pullback condition. I think there should be a model structure on this, where we have
\begin{itemize}

\item Cofibrations are maps with $i$ and $\widetilde{\jmath}$ embeddings.

\item Weak equivalences are maps that are homeomorphisms on the zero set, and which are quasi-isomorphisms on the tangent complex \jake{[to be defined]} around the zero set.

\item Fibrations should have at least that the map $Y_0 \to Y_1$ be a submersion, plus probably the homotopy lifting property.

\end{itemize}
I think I can show that the acyclic cofibrations are just the things I'm calling morphisms of thickening charts above, with the extra condition that the zero sets be the same.
\end{wild-speculation}

\begin{remark}
\jake{There are two functors out of $\cT$ that should be very interesting. The first is a functor to Hausdorff spaces and open embeddings, and is called ``take the zero set of the section $f$." The second is a functor to smooth manifolds, called ``forget the vector bundle $E$ and the section $f$."}
\end{remark}

\begin{prop}\label{weak-pullback-charts}
The category $\cT$ has weak pushouts, and hence $\CoSpan^\bullet(\cT)$ is a Kan complex. \jake{[This is not true, only locally true.]}
\end{prop}

\begin{proof}
\jake{[To be done.]}
\end{proof}

\begin{prop}\label{weak-initial-charts}
Let $\cU$ be a thickening chart, and let $\cT_\cU$ denote the full subcategory of $\cT$ on those thickening charts $\cV$ such that $\cU$ and $\cV$ are in the same connected component of $\CoSpan^\bullet(\cT)$. Then $\cT_\cU$ has a weak initial object, and hence $\CoSpan^\bullet(\cT)$ is the disjoint union of contractible components. \jake{[This is not true, only locally true.]}
\end{prop}

\begin{proof}
\jake{[To be done.]}
\end{proof}

\subsection{Model structure on thickening charts}

\begin{definition}\label{thickening-model-structure}
We define a category of thickening charts and their tangent complexes, together with specified classes of cofibrations, fibrations, and weak equivalences, as follows.
\begin{itemize}

\item Objects are thickening charts $\cX = (Y_\cX, E_\cX, f_\cX)$, consisting of a smooth manifold $Y$, a smooth vector bundle $E_\cX$ over $Y_\cX$, and a smooth section $f_\cX$ of $E_\cX$. We will use the notation $\cX_0 = f_\cX^{-1}(0) \subset Y_\cX$ to denote the underlying topological space of $\cX$.

\item A pre-morphism $\cF = (U_\cF, i_\cF, j_\cF): \cX \to \cZ$ is given by an open neighborhood $U_\cF$ of $\cX_0$ in $Y_\cX$, together with a smooth map $i_\cF: U_\cF \to Y_\cZ$ and a smooth map $j_\cF: \rest{E_\cX}{U_\cF} \to \rest{i_\cF^* E_\cZ}U_{\cF}$ of vector bundles such that $j_\cF \circ f_\cX = i_\cF^*(f_\cZ)$. A morphism is an equivalence class of pre-morphisms, where two pre-morphisms defined on neighborhoods $U_1, U_2$ are declared equivalent if they agree on a smaller neighborhood $U \subset U_1, U_2$. We will usually abuse notation and consider $\cF$ above to be a morphism, remembering that it is just the germ of $\cF$ around $\cX_0$ that matters.

\item Given a thickening chart $\cX$ and a point $x \in \cX_0$, we define the tangent complex $T_x \cX$ of $\cX$ at $x$ to be the chain complex
\[\xymatrix{ \cdots & 0 \ar[l] & \left(E_\cX\right)_x \ar[l] & T_x Y_\cX \ar[l]_-{(df_\cX)_x} & 0 \ar[l] & \cdots \ar[l] }\]
with $T_x Y_\cX$ in degree zero. This is well defined because $f_\cX(x) = 0$. The assignment $(\cX, x) \mapsto T_x \cX$ defines a functor from pointed thickening charts to chain complexes. We will use $d \cF_x: T_x \cX \to T_{i_\cF(x)} \cZ$ to denote the action of this functor on a morphism $\cF: \cX \to \cY$.

\item A morphism $\cF : \cX \to \cZ$ is a cofibration if the induced map $\rest{i_\cF}{\cX_0}: \cX_0 \to \cZ_0$ is an embedding, and if $d \cF_x$ is a cofibration of chain complexes, i.e. a level-wise injection, for every $x \in \cX_0$.

\item A morphism $\cF : \cX \to \cZ$ is a fibration if $d \cF_x$ is a fibration of chain complexes, i.e. a level-wise surjection, for every $x \in \cX_0$.

\item A morphism $\cF : \cX \to \cZ$ is a weak equivalence if the induced map $\rest{i_\cF}{\cX_0}: \cX_0 \to \cZ_0$ is a homeomorphism, and if $d \cF_x$ is a quasi-isomorphism of chain complexes for every $x \in \cX_0$.

\end{itemize}
\end{definition}

\begin{prop}\label{model-structure}
The above classes of cofibrations, fibrations, and weak equivalences is a model structure on the category of thickening charts, in the sense of Goerss-Jardine. \jake{[Add reference.]} \jake{Note that the category of thickening charts is not complete or cocomplete.}
\end{prop}

\begin{proof}

First, we must show that the weak equivalences satisfy the 2-out-of-3 property, but this is immediate from the same fact about homeomorphisms of topological spaces and quasi-isomorphisms of chain complexes. Similarly, the closure of cofibrations, fibrations, and weak equivalences under retracts follows from the corresponding facts about embeddings, fiber bundles, and homeomorphisms \jake{[Check this!]}, as well as for cofibrations, fibrations, and quasi-isomorphisms of chain complexes.

To show the existence of factorizations, let $\cF: \cX \to \cZ$ be any morphism. WLOG, we may assume that $U_\cF = Y_\cX$ \jake{[Add lemma explaining that open inclusions arke isos]}. Consider the graph $\Gamma \subset Y_\cX \times Y_\cZ$ of the map $i_\cF$. By the tubular neighborhood theorem, there exists an open neighborhood $U$ of $\Gamma$ such that $U \cong \Gamma \times $

\end{proof}

\subsection{Simplicial sheaf of $n$-thickenings}

\begin{defn}\label{n-thickening}
Let $X$ be a Hausdorff space. An {\bf $n$-thickening} is the data of a smooth manifold $Y$, together with vector spaces $E_0, \dots, E_n$ \jake{[maybe to avoid needing to sheafify, let $E_i$ be a vector bundle over $Y$]} and maps $\sigma_i: Y \to E_i$, and a homeomorphism $\psi: X \to \sigma^{-1}(0)$ (usually suppressed), where $\sigma = \sigma_0 \oplus \cdots \oplus \sigma_n$. We also demand a transversality requirement for $n \geq 1$. \jake{[Spell this out... it should be that all the simultaneous zero sets except the zero set of all the $\sigma_i$ at once are smooth manifolds cut out transversely.]}
\hiro{We certainly should spell this out; your transversality condition sounds like it only kicks in for $k$-simplices with $k \geq 2$.}

Two $n$-thickenings $(Y^k, (E_i^k, \sigma_i^k))$, for $k = 1, 2$, are declared equivalent if they are isomorphic when restricted to open neighborhoods $X \subset U^k \subset Y^k$ (thus $n$-thickenings only depend on the germs of the functions $\sigma_i$ around $X$).
\hiro{It might be nicer to talk about refinements. There's a filtered structure on these $n$-thickenings given by refinements---a refinement would be an (open?) embedding of the manifolds, together with embeddings of vector spaces that are all compatible with the $s_i$. There's probably a clean categorical way to say this---there's a category of $n$-thickenings that has a forgetful functor to $\Delta^{\op}$.}
\end{defn}

\jake{[Details here to be worked out and clarified. In particular, need to explain what ``compatible with $\cA$" means, as well as addressing the fact that the zero sets $f_i^{-1}(0)$ won't be smooth manifolds. Proving the simplicial identities would be good too.]}

Let $X$ be a Hausdorff space. There is a simplicial (pre?)sheaf $\cT \cH_X^\bullet$ on $X$, called the {\bf thickening sheaf} of $X$, given on an open $U \subset X$ by
\[ \cT \cH_X^n(U) = \left\{ \text{$n$-thickenings of $U$} \right\}. \]
The face maps are given by
\[ d_i : \left( Y, (E_0, \sigma_0; \dots; E_n, \sigma_n) \right) \mapsto \left( \sigma_i^{-1}(0), (E_0, \sigma_0; \dots; \wh E_i; \wh \sigma_i, \dots ; E_n, \sigma_n) \right), \]
and the degeneracies are given by
\[ s_i : \left( Y, (E_0, \sigma_0; \dots; E_n, \sigma_n) \right) \mapsto \left( Y \times E_i, (E_0, \sigma_0; \dots; E_i, \pi_2 - \sigma_i \circ \pi_1; E_i, \pi_2; \dots; E_n, \sigma_n) \right). \]
Finally, if $V \subset U$ is open, then the restriction map is given by
\[ r_{U, V}: \left( Y, (E_0, \sigma_0; \dots; E_n, \sigma_n) \right) \mapsto \left( W, (E_0, \rest{\sigma_0}{W}; \dots; E_n, \rest{\sigma_n}{W}) \right), \]
where $W \subset Y$ is any open subset with $W \cap U = V$. Any two choices of such a $W$ are equivalent, since we are working locally around $X$.

\begin{prop}\label{thickenings-are-kan-complexes}
The simplicial set $\cT \cH^\bullet(X)$ is a Kan complex.
\end{prop}

\begin{proof}
\jake{[Proof only works locally on $X$ really, but sheafifying should solve that.]} By symmetry in the definition of $\cT \cH^\bullet(X)$, it suffices to prove the claim for a $0$-horn, given by the $n$-thickenings
\[ (Y^k, (E_0, \sigma_0^k; \dots; \wh E_k, \wh \sigma_k^k; \dots; E_n, \sigma_n^k)), \]
for $1 \leq k \leq n$. Define
\[ Z^k = (\sigma_1^k)^{-1}(0) \cap \dots \cap \wh {(\sigma_k^k)^{-1}(0)} \cap \dots \cap (\sigma_n^k)^{-1}(0) \subset Y^k. \]
We have that $Z^k$ is a smooth submanifold of $Y^k$, and further we have $Z^1 \cong \dots \cong Z^n$ because the given data is a horn; we now suppress these isomorphisms and write $Z$ for this space. Now, define
\[ W^{k, j} = (\sigma_1^k)^{-1}(0) \cap \dots \cap \dots \cap \wh {(\sigma_j^k)^{-1}(0)} \cap \dots \cap \wh {(\sigma_k^k)^{-1}(0)} \cap \dots \cap (\sigma_n^k)^{-1}(0) \subset Y^k, \]
for $1 \leq j \neq k \leq n$. We have that $W^{k, j}$ is a smooth submanifold of $Y^k$, and further we have that $W^{1, j} \cong \dots \cong \wh {W^{j, j}} \cong \dots W^{n, j}$, which we will suppress and denote by $W^j$.

By the inverse function theorem, the transversality conditions in $\cT \cH^\bullet(X)$, and the fact that we are identifying $n$-thickenings which agree in a neighborhood of $X$, we may assume WLOG, but not canonically, that $W^j \cong Z \times E_j$ \jake{[locally on X]}, and further that
\[ Y^k = Z \times E_1 \times \dots \times \wh E_k \times \dots \times E_n, \]
in such a way that $\sigma_i^k = \pi_{E_i}$. But we may then define an $(n + 1)$-thickening that fills the horn, namely
\[ \left( Z \times E_1 \times \dots \times E_n, \left( E_0, \sigma_0; E_1, \pi_{E_1}; \dots; E_n, \pi_{E_n} \right) \right), \]
where we have defined
\[\sigma_0(z, x_1, \dots, x_n) = \sum_{\varnothing \neq I \subseteq \{1, \dots, n\}} (-1)^{\abs{I}} \sigma_0^I(z, x_1, \dots, \wh x_I, \dots, x_n), \]
where $\sigma_0^I: Z \times E_1 \times \dots \times \wh E_I \times \dots \times E_n \to E_0$ is the restriction of $\sigma_0^i$ for any $i \in I$. It is easy to check that we have
\[ \sigma_0(z, x_1, \dots, x_i = 0, \dots, x_n) = \sigma_0^i(z, x_i, \dots, \wh x_i, \dots, x_n), \]
as well as that the transversality condition is satisfied, and thus this is a filler for the given horn.
\end{proof}

\begin{prop}\label{thickenings-are-discrete}
The simplicial set $\cT \cH^\bullet(U)$ is equivalent to a discrete simplicial set.
\end{prop}

\begin{proof}
\jake{[Proof again only works locally on $X$, some sheafy details to be worked out.]}

We show that each component of $\TH^\bullet(U)$ is contractible. Let $p = (Y, (E, f)) \in \TH^0(U)$ be such that $Y$ is of minimal dimension among all thickenings in the connected component of $p$. We claim that any $n$-simplex $(W, (E_0, f_0, \dots, E_n, f_n))$ with vertices at $p$ is necessarily degenerate at $p$, which would imply that the component of $p$ is contractible since $X$ is a Kan complex.

We proceed by induction on $n$. For $n = 1$, suppose we have a $1$-simplex $q = (W, (E_0, f_0, E_1, f_1))$ with vertices given by $p$. Explicitly, this means we are given embeddings $\iota_i : Y \to W$ such that $Y_i = \im(\iota_i)$ satisfies $Y_0 = f_1^{-1}(0)$ and vice versa, together with (not necessarily linear) isomorphisms of bundles $u_i: \overline{E} \to \iota_i^* \overline{E_i}$ such that $u_i \circ f = \iota_i^* (f_i)$. Choose $x \in U$, and consider the map
\[ df_0 \oplus df_1 : T_x W \to E_0 \oplus E_1. \]
We claim that the rank of this map is equal to the dimension of $E \cong E_i$. Suppose not. Then we would have that $\ker(df_0 \oplus df_1)$ had dimension strictly lower than that of $\ker(df_i)$, which by Lemma \ref{minimal-dimension} would construct a thickening of strictly lower dimension than $Y$ in the same connected component, contradicting the minimality of $Y$.

Now, we have that $F = \im(df_0 \oplus df_1)$ has dimension equal to that of $E_i$, and further that $\pi_i : F \to E_i$ is an isomorphism since $df_i$ is surjective. Thus, we may identify $E_i$ with $F$ by this given isomorphism, and we may assume that
\[ q = (W, (F, f_0, F, f_1)), \]
such that $\im(df_0 \oplus df_1)$ at $x$ is the diagonal $F \oplus F$, or equivalently, such that $df_0 = df_1$ as maps $T_x W \to F$. Now, choose an isomorphism $h: E \to F$ of vector spaces, and consider the map

\end{proof}

\begin{lemma}\label{minimal-dimension}
Let $(W, (E_0, f_0, E_1, f_1))$ be a $1$-thickening of $U$ with endpoints $p_i = (Y_i, (E_i, f_i))$, for $Y_0 = f_1^{-1}(0)$ and vice versa. Let $x \in U$, and let
\[d = \dim(T_x Y_1 \cap T_x Y_2).\]
Then there exists a $0$-thickening $q = (Z, (H, h))$ of some neighborhood $V$ of $x$ in $U$ with $\dim(Z) = d$, and such that $q$ is in the same connected component of $\TH^\bullet(V)$ as $r_{U, V}(p_i)$.
\end{lemma}

\begin{proof}

Consider
\[ df_1 \oplus df_2 : T_x W \to E_1 \oplus E_2, \]
and let $F = \im(df_1 \oplus df_2)$. Choose a complement $H$ for $F$ such that $H \subset E_1$; such an $F$ exists because $df_2$ is surjective by transversality. Let $\pi_F, \pi_H$ be the projections induced by this decomposition, and consider the function 
\[g = \pi_F \circ (f_1 \oplus f_2) : W \to F.\]
We have that $dg$ is surjective at $x$, and so there is a neighborhood $V$ of $x$ where $Z = g^{-1}(0)$ is a smooth manifold. Consider now the $0$-thickening $q$ of $V$ given by
\[ q = (Z, (H, h = f_1)),\]
which is well defined, since on $Z$ we have that $f_1$ takes values in $H$. This thickening has
\[ \dim(Z) = \dim(\ker(df_2 \oplus df_2)) = d,\]
and further there is a $1$-thickening
\[ (f_1^{-1}(H), (H, f_1, E_2, f_2)), \]
with endpoints given by
\[ (f_1^{-1}(0), (E_2, f_2)) = (Y, (E, f)), \]
and
\[ (f_1^{-1}(H) \cap f_2^{-1}(0), (H, f_1)) = (Z, (H, h)), \]
and thus we have found the desired thickening.

\end{proof}

\begin{definition}\label{implicit-manifold}
An {\bf implicit manifold} is a compact Hausdorff space $X$ together with a choice of global section of $\cT \cH^\bullet(X)$. \jake{This should agree with Pardon's definition of an implicit atlas.}
\end{definition}

We have the following candidate for the structure sheaf of $(X, \cA)$ as a derived manifold. Consider the simplicial sheaf $\cO_X^\bullet$ on $X$, given by
\[ \cO_X^n(U) = \coprod_{(Y, (E_i, \sigma_i)) \in \cT \cH_\cA^n(U)} C^\oo(Y). \]

\hiro{I think this is a beautiful candidate. Do you want to try and work out the speculation? Spivak at some point must do something very similar in his thesis.}

\begin{speculation}
If $X$ is a smooth manifold, then $\cO_X^\bullet(X)$ is equivalent to the discrete simplicial set $C^\oo(X)$. Further, if $X$ is the intersection of the origin in $\RR$ with itself, then $\pi_0(\cO_X^\bullet(X)) \cong \RR$ and $\pi_1(\cO_X^\bullet(X)) \cong \RR$. To see this last part, consider smooth functions on $\RR^n$ that vanish on the coordinate hyperplanes, and see how strong a zero they must have when restricted to another generic plane.
\end{speculation}